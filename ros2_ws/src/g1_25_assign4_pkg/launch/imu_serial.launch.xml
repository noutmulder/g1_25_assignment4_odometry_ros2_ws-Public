<?xml version="1.0"?>
<launch>
  <!-- Serial IMU node (lifecycle executable run as normal node; manage transitions via ros2 lifecycle CLI if needed) -->
  <node pkg="g1_25_assign4_pkg" exec="serial_imu_node" name="serial_imu_node" output="screen">
    <param name="serial_port" value="/dev/ttyACM0"/>
    <param name="baud_rate" value="115200"/>
    <param name="publish_rate_ms" value="10"/>
  </node>

  <!-- IMU integration to odom -->
  <node pkg="g1_25_assign4_pkg" exec="accel_velocity_approximator" name="accel_velocity_approximator" output="screen">
    <param name="odom_frame_id" value="odom"/>
    <param name="base_frame_id" value="base_link"/>
    <param name="remove_gravity_z" value="true"/>
    <param name="use_orientation_for_gravity" value="false"/>
    <param name="gravity_m_s2" value="9.81"/>
    <param name="accel_smoothing_alpha" value="0.2"/>
    <param name="accel_deadband" value="0.02"/>
    <param name="velocity_damping" value="0.02"/>
    <param name="max_dt_seconds" value="0.2"/>
  </node>

  <!-- Wheel encoder odometry (expects /wheel/encoder) -->
  <node pkg="g1_25_assign4_pkg" exec="wheel_encoder_odometry" name="wheel_encoder_odometry" output="screen">
    <param name="wheel_radius" value="0.05"/>
    <param name="track_width" value="0.20"/>
  </node>

  <!-- Database Subscriber Node -->
  <node pkg="g1_25_assign4_pkg" exec="imu_database_node" name="imu_database_node" output="screen">
    <param name="database_path" value="imu_data.db"/>
  </node>

  <!-- Visualizer Node -->
  <node pkg="g1_25_assign4_pkg" exec="imu_vector_visualizer" name="imu_vector_visualizer" output="screen"/>

  <!-- RViz2 Node -->
  <node pkg="rviz2" exec="rviz2" name="rviz2" output="screen"
        args="-d $(find-pkg-share g1_25_assign4_pkg)/rviz/display.rviz"/>
</launch>
